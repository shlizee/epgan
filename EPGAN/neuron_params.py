"""
ElectroPhysiomeGAN: Generation of Biophysical Neuron Model Parameters from Recorded Electrophysiological Responses
Copyright (c) 2024-2025 University of Washington. Developed in UW NeuroAI Lab by Jimin Kim.
"""

import os
import numpy as np

########################################################################################################################################################################
# NEURAL PARAMETERS FOR GENERIC CBM ####################################################################################################################################
########################################################################################################################################################################

ms_2_s = 0.001

# Default parameters used for the HH-model
# Nicoletti, Martina, et al. "Biophysical modeling of the whole-cell dynamics of C. elegans motor and interneurons families." PloS one 19.3 (2024): e0298105.

generic_model_params = {
    
    "SHL1_g": 0.94,                        #0 1     nS   (0, 3)
    "SHL1_m_inf_Veq": -6.8,                #1 2     mV   (-90, 0)
    "SHL1_m_inf_ka": 14.1,                 #2 3     mV   (0, 30)
    "SHL1_h_inf_Veq": -40,                 #3 4     mV   (-90, 0)
    "SHL1_h_inf_ka": 8.3,                  #4 5     mV   (0, 30)
    "SHL1_m_tau_a": 1.4,                   #5 6     ms   (0, 1500)
    "SHL1_m_tau_b": -17.5,                 #6 7     mV   (-90, 0)
    "SHL1_m_tau_c": 12.9,                  #7 8     mV   (0, 30)
    "SHL1_m_tau_d": -3.7,                  #8 9     mV   (-90, 0)
    "SHL1_m_tau_e": 6.5,                   #9 10    mV   (0, 30)
    "SHL1_m_tau_f": 0.2,                   #10 11   ms   (0, 1500)
    "SHL1_hf_tau_a": 53.9,                 #11 12   ms   (0, 1500)
    "SHL1_hf_tau_b": -28.2,                #12 13   mV   (-90, 0)
    "SHL1_hf_tau_c": 4.9,                  #13 14   mV   (0, 30)
    "SHL1_hf_tau_d": 27.3,                 #14 15   ms   (0, 1500)
    "SHL1_hs_tau_a": 842.2,                #15 16   ms   (0, 1500)
    "SHL1_hs_tau_b": -37.7,                #16 17   mV   (-90, 0)
    "SHL1_hs_tau_c": 6.4,                  #17 18   mV   (0, 30)
    "SHL1_hs_tau_d": 11.9,                 #18 19   ms   (0, 1500)
    "SHK1_g": 0,                           #19 20   nS   (0, 3)
    "SHK1_m_inf_Veq": 2,                   #20 21   mV   (-90, 0)
    "SHK1_m_inf_ka": 10,                   #21 22   mV   (0, 30)
    "SHK1_h_inf_Veq": -6.95,               #22 23   mV   (-90, 0)
    "SHK1_h_inf_ka": 5.8,                  #23 24   mV   (0, 30)
    "SHK1_m_tau_a": 26.6,                  #24 25   ms   (0, 1500)
    "SHK1_m_tau_b": -33.7,                 #25 26   mV   (-90, 0)
    "SHK1_m_tau_c": 15.8,                  #26 27   mV   (0, 30)
    "SHK1_m_tau_d": -33.7,                 #27 28   mV   (-90, 0)
    "SHK1_m_tau_e": 15.4,                  #28 29   mV   (0, 30)
    "SHK1_m_tau_f": 2,                     #29 30   ms   (0, 1500)
    "SHK1_tau_h": 1400,                    #30 31   ms   (0, 1500)
    "EGL2_g": 0.15,                        #31 32   nS   (0, 3)
    "EGL2_m_inf_Veq": -6.9,                #32 33   mV   (-90, 0)
    "EGL2_m_inf_ka": 14.9,                 #33 34   mV   (0, 30)
    "EGL2_m_tau_a": 8.39,                  #34 35   ms   (0, 1500)
    "EGL2_m_tau_b": -122.6,                #35 36   mV   (-90, 0)
    "EGL2_m_tau_c": 13.8,                  #36 37   mV   (0, 30)
    "EGL2_m_tau_d": 4.04,                  #37 38   ms   (0, 1500)
    "IRK13_g": 0.34,                       #38 39   nS   (0, 3)
    "IRK13_m_inf_Veq": -82,                #39 40   mV   (-90, 0)
    "IRK13_m_inf_ka": 13,                  #40 41   mV   (0, 30)
    "IRK13_m_tau_a": 17.1,                 #41 42   ms   (0, 1500)
    "IRK13_m_tau_b": -17.8,                #42 43   mV   (-90, 0)
    "IRK13_m_tau_c": 20.3,                 #43 44   mV   (0, 30)
    "IRK13_m_tau_d": 43.4,                 #44 45   mV   (-90, 0)
    "IRK13_m_tau_e": 11.2,                 #45 46   mV   (0, 30)
    "IRK13_m_tau_f": 3.8,                  #46 47   ms   (0, 1500)
    "UNC103_g": 0,                         #47 48   nS   (0, 3)
    "UNC103_m_inf_Veq": -15.1,             #48 49   mV   (-90, 0)
    "UNC103_m_inf_ka": 7.85,               #49 50   mV   (0, 30)
    "UNC103_h_inf_Veq": -48,               #50 51   mV   (-90, 0)
    "UNC103_h_inf_ki": 28,                 #51 52   mV   (0, 30)
    "UNC103_m_tau_a": 87.4,                #52 53   ms   (0, 1500)
    "UNC103_m_tau_b": -28.33,              #53 54   mV   (-90, 0)
    "UNC103_m_tau_c": 13.1,                #54 55   mV   (0, 30)
    "UNC103_m_tau_d": 0.26,                #55 56   ms   (0, 1500)
    "UNC103_h_tau_a": 8.16,                #56 57   ms   (0, 1500)
    "UNC103_h_tau_b": -25.28,              #57 58   mV   (-90, 0)
    "UNC103_h_tau_c": 29.5,                #58 59   mV   (0, 30)
    "UNC103_h_tau_d": 0.23,                #59 60   ms   (0, 1500)
    "KQT1_g": 0,                           #60 61   nS   (0, 3)
    "KQT1_m_inf_Veq": -17.61,              #61 62   mV   (-90, 0)
    "KQT1_m_inf_ka": 9.58,                 #62 63   mV   (0, 30)
    "KQT1_s_inf_Veq_a": -86.84,            #63 64   mV   (-90, 0)
    "KQT1_s_inf_ks_a": 15.05,              #64 65   mV   (0, 30)
    "KQT1_s_inf_a": 0.41,                  #65 66   r    (0.41, 0.41)
    "KQT1_s_inf_Veq_b": 70.13,             #66 67   mV   (-90, 0)
    "KQT1_s_inf_ks_b": 13.37,              #67 68   mV   (0, 30)
    "KQT1_s_inf_b": 0.59,                  #68 69   r    (0.59, 0.59)
    "KQT1_m_tau_a": 895.9,                 #69 70   ms   (0, 1500)
    "KQT1_m_tau_b": -18.01,                #70 71   mV   (-90, 0)
    "KQT1_m_tau_c": 31.04,                 #71 72   mV   (0, 30)
    "KQT1_m_tau_d": 10,                    #72 73   ms   (0, 1500)
    "KQT1_s_tau_a": 185845,                #73 74   ms   (0, 1500)
    "KQT1_s_tau_b": 39.44,                 #74 75   mV   (0, 30)
    "KQT1_s_tau_c": 7.34,                  #75 76   mV   (0, 30)
    "KQT1_s_tau_d": 1077,                  #76 77   ms   (0, 1500)
    "EXP2_g": 0,                           #77 78   nS   (0, 3)
    "EXP2_m_inf_Veq": -17,                 #78 79   mV   (-90, 0)
    "EXP2_m_inf_ka": 6.5,                  #79 80   mV   (0, 30)
    "EXP2_h_inf_Veq": -50,                 #80 81   mV   (-90, 0)
    "EXP2_h_inf_ki": 10,                   #81 82   mV   (0, 30)
    "EXP2_m_tau_a": 40,                    #82 83   ms   (0, 1500)
    "EXP2_m_tau_b": -20.52,                #83 84   mV   (-90, 0)
    "EXP2_m_tau_c": 4.71,                  #84 85   mV   (0, 30)
    "EXP2_m_tau_d": 2.4,                   #85 86   ms   (0, 1500)
    "EXP2_h_tau_a": 1.28,                  #86 87   ms   (0, 1500)
    "EXP2_h_tau_b": -89.02,                #87 88   mV   (-90, 0)
    "EXP2_h_tau_c": 49.35,                 #88 89   mV   (0, 30)
    "EXP2_h_tau_d": 0.87,                  #89 90   ms   (0, 1500)
    "SLO1_g": 0,                           #90 91   nS   (0, 3)
    "SLO1_CaV_g": 0,                       #91 92   nS   (0, 3)
    "SLO1_wyx": 0.013,                     #92 93   mV-1 (0.013, 0.013)
    "SLO1_wxy": -0.028,                    #93 94   mV-1 (-0.028, -0.028)
    "SLO1_w0_neg": 3.15,                   #94 95   ms-1 (3.15, 3.15)
    "SLO1_w0_pos": 0.16,                   #95 96   ms-1 (3.15, 3.15)
    "SLO1_Kxy": 55.73,                     #96 97   uM   (55.73, 55.73)
    "SLO1_nxy": 1.3,                       #97 98        (1.3, 1.3)
    "SLO1_Kyx": 34.34,                     #98 99   uM   (34.34, 34.34)
    "SLO1_nyx": 10e-4,                     #99 100       (10e-4, 10e-4)
    "SLO2_g": 0,                           #100 101 nS   (0, 3)
    "SLO2_CaV_g": 0,                       #101 102 nS   (0, 3)
    "SLO2_wyx": 0.019,                     #102 103 mV-1 (0.019, 0.019)
    "SLO2_wxy": -0.024,                    #103 104 mV-1 (-0.024, -0.024)
    "SLO2_w0_neg": 0.9,                    #104 105 ms-1 (0.9, 0.9)
    "SLO2_w0_pos": 0.027,                  #105 106 ms-1 (0.027, 0.027)
    "SLO2_Kxy": 93.45,                     #106 107 uM   (93.45, 93.45)
    "SLO2_nxy": 1.84,                      #107 108      (1.84, 1.84)
    "SLO2_Kyx": 3294.55,                   #108 109 uM   (3294.55, 3294.55)
    "SLO2_nyx": 10e-5,                     #109 110      (10e-5, 10e-5)
    "EGL19_g": 0.1,                        #110 111 nS   (0, 3)
    "EGL19_m_inf_Veq": -5.6,               #111 112 mV   (-90, 0)
    "EGL19_m_inf_ka": 7.5,                 #112 113 mV   (0, 30)
    "EGL19_h_inf_Veq": 14.9,               #113 114 mV   (-90, 0)
    "EGL19_h_inf_ki": 12,                  #114 115 mV   (0, 30)
    "EGL19_h_inf_Veq_b": -20.5,            #115 116 mV   (-90, 0)
    "EGL19_h_inf_ki_b": 8.1,               #116 117 mV   (0, 30)
    "EGL19_h_inf_a": 1.43,                 #117 118      (1.43, 1.43)
    "EGL19_h_inf_b": 0.14,                 #118 119      (0.14, 0.14)
    "EGL19_h_inf_c": 5.96,                 #119 120      (5.96, 5.96)
    "EGL19_h_inf_d": 0.6,                  #120 121      (0.6, 0.6)
    "EGL19_m_tau_a": 2.9,                  #121 122 ms   (0, 1500)
    "EGL19_m_tau_b": -4.8,                 #122 123 mV   (-90, 0)
    "EGL19_m_tau_c": 6,                    #123 124 mV   (0, 30)
    "EGL19_m_tau_d": 1.9,                  #124 125 ms   (0, 1500)
    "EGL19_m_tau_e": -8.6,                 #125 126 mV   (-90, 0)
    "EGL19_m_tau_f": 30,                   #126 127 mV   (0, 30)
    "EGL19_m_tau_g": 2.3,                  #127 128 ms   (0, 1500)
    "EGL19_h_tau_a": 0.4,                  #128 129      (0.4, 0.4)
    "EGL19_h_tau_b": 44.6,                 #129 130 ms   (0, 1500)
    "EGL19_h_tau_c": -33,                  #130 131 mV   (-90, 0)
    "EGL19_h_tau_d": 5,                    #131 132 mV   (0, 30)
    "EGL19_h_tau_e": 36.4,                 #132 133 ms   (0, 1500)
    "EGL19_h_tau_f": 18.7,                 #133 134 mV   (-90, 0)
    "EGL19_h_tau_g": 3.7,                  #134 135 mV   (0, 30)
    "EGL19_h_tau_h": 43.1,                 #135 136 ms   (0, 1500)
    "UNC2_g": 0.33,                        #136 137 nS   (0, 3)
    "UNC2_m_inf_Veq": -37.2,               #137 138 mV   (-90, 0)
    "UNC2_m_inf_ka": 4,                    #138 139 mV   (0, 30)
    "UNC2_h_inf_Veq": -77.5,               #139 140 mV   (-90, 0)
    "UNC2_h_inf_ki": 5.6,                  #140 141 mV   (0, 30)
    "UNC2_m_tau_a": 1.5,                   #141 142 ms   (0, 1500)
    "UNC2_m_tau_b": -38.2,                 #142 143 mV   (-90, 0)
    "UNC2_m_tau_c": 9.1,                   #143 144 mV   (0, 30)
    "UNC2_m_tau_d": 15.4,                  #144 145 mV   (0, 30)
    "UNC2_m_tau_e": 0.1,                   #145 146 ms   (0, 1500)
    "UNC2_h_tau_a": 142.5,                 #146 147 ms   (0, 1500)
    "UNC2_h_tau_b": 22.9,                  #147 148 mV   (-90, 0)
    "UNC2_h_tau_c": -3.5,                  #148 149 mV   (0, 30)
    "UNC2_h_tau_d": 122.6,                 #149 150 ms   (0, 1500)
    "UNC2_h_tau_e": -6.1,                  #150 151 mV   (-90, 0)
    "UNC2_h_tau_f": -3.6,                  #151 152 mV   (0, 30)
    "CCA1_g": 0.87,                        #152 153 nS   (0, 3)
    "CCA1_m_inf_Veq": -57.5,               #153 154 mV   (-90, 0)
    "CCA1_m_inf_ka": 7.6,                  #154 155 mV   (0, 30)
    "CCA1_h_inf_Veq": -73,                 #155 156 mV   (-90, 0)
    "CCA1_h_inf_ki": 7,                    #156 157 mV   (0, 30)
    "CCA1_m_tau_a": 20,                    #157 158 ms   (0, 1500)
    "CCA1_m_tau_b": -92.5,                 #158 159 mV   (-90, 0)
    "CCA1_m_tau_c": 21.1,                  #159 160 mV   (0, 30)
    "CCA1_m_tau_d": 0.4,                   #160 161 ms   (0, 1500)
    "CCA1_h_tau_a": 22.4,                  #161 162 ms   (0, 1500)
    "CCA1_h_tau_b": -75.7,                 #162 163 mV   (-90, 0)
    "CCA1_h_tau_c": 9.4,                   #163 164 mV   (0, 30)
    "CCA1_h_tau_d": 1.6,                   #164 165 ms   (0, 1500)
    "NCA_g": 0,                            #165 166 nS   (0, 3)
    "LEAK_g": 0.1,                         #166 167 nS   (0, 3)
    "Ca_F": 9.6485e4,                      #167 168      (9.6485e4, 9.6485e4)
    "Ca_d": 0.1,                           #168 169      (0.1, 0.1)
    "Ca_A": 1,                             #169 170      (1, 1)
    "Ca_Beta": 1,                          #170 171 ms-1 (1, 1)
    "VK": -80,                             #171 172 mV   (-100, 0)
    "VCa": 60,                             #172 173 mV   (20, 150)
    "VNa": 30,                             #173 174 mV   (20, 150)
    "VLEAK": -50,                          #174 175 mV   (-80, 30)
    "V0": -48,                             #175 176 mV   (-90, 0)
    "m_SHL1_0": 0,                         #176 177      (0, 1)
    "dh_SHL1_f_0": 0,                      #177 178      (0, 1)
    "dh_SHL1_s_0": 0,                      #178 179      (0, 1)
    "dm_SHK1_0": 0,                        #179 180      (0, 1)
    "dh_SHK1_0": 0,                        #180 181      (0, 1)
    "dm_EGL2_0": 0,                        #181 182      (0, 1)
    "dm_IRK13_0": 0,                       #182 183      (0, 1)
    "dm_UNC103_0": 0,                      #183 184      (0, 1)
    "dh_UNC103_0": 0,                      #184 185      (0, 1)
    "dm_KQT1_0": 0,                        #185 186      (0, 1)
    "ds_KQT1_0": 0,                        #186 187      (0, 1)
    "dm_EXP2_0": 0,                        #187 188      (0, 1)
    "dh_EXP2_0": 0,                        #188 189      (0, 1)
    "dm_SLO1_0": 0,                        #189 190      (0, 1)
    "dm_SLO2_0": 0,                        #190 191      (0, 1)
    "dm_SLO1_EGL19_0": 0,                  #191 192      (0, 1)
    "dm_SLO1_UNC2_0": 0,                   #192 193      (0, 1)
    "dm_SLO2_EGL19_0": 0,                  #193 194      (0, 1)
    "dm_SLO2_UNC2_0": 0,                   #194 195      (0, 1)
    "dm_EGL19_0": 0,                       #195 196      (0, 1)
    "dh_EGL19_0": 0,                       #196 197      (0, 1)
    "dm_UNC2_0": 0,                        #197 198      (0, 1)
    "dh_UNC2_0": 0,                        #198 199      (0, 1)
    "dm_CCA1_0": 0,                        #199 200      (0, 1)
    "dh_CCA1_0": 0,                        #200 201      (0, 1)
    "dCa2_0": 1e-4,                        #201 202      (0, 1)
    "C": 1.55                              #202 203 pF   (0, 10)
}